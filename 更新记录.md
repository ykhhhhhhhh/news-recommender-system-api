### 2021.9.18

#### 词表维护

文章：新凝胶可减少土地用水并避免污染 调整前结果：

('相关', 0.93515625,

['精细化工',
80.35714285714285, ['生物降解', '添加剂', '水凝胶', '清洁生产', '纤维素', '蛋白质', '农业生产', '聚合物', '化学物质', '土壤污染', '化学品', '糖', '新材料', '使用寿命', '混合', '水分', '地下水', '生物医学']
, 18],

['高分子化学',
62.499999999999986, ['水凝胶', '纤维素', '聚合物', '生物降解', '清洁生产', '添加剂', '蛋白质', '食品工业', '糖', '土壤污染', '海藻酸', '地下水', '化学品', '相关研究']
, 14],

['石油天然气能',
62.499999999999986, ['聚合物', '添加剂', '清洁生产', '蛋白质', '俄罗斯', '土壤污染', '新技术', '地下水', '生物降解', '纤维素', '水凝胶', '化学物', '技术研究', '使用寿命']
, 14],

['环境化学',
62.499999999999986, ['地下水', '生物降解', '添加剂', '土壤污染', '化学物质', '纤维素', '土壤', '蛋白质', '地表水', '聚合物', '化学品', '化学物', '生物聚合', '食品工业']
, 14],

['三废',
62.499999999999986, ['清洁生产', '地下水', '土壤污染', '生物降解', '化学物质', '添加剂', '新技术', '蛋白质', '纤维素', '聚合物', '化学品', '技术研究', '水凝胶', '新材料']
, 14]], [('土壤', 5), ('农业', 5), ('水凝胶', 3), ('肥料', 3), ('化学物', 2)])

**垃圾词：混合，相关研究，使用寿命，俄罗斯，新技术，技术研究，化学物 ok**

删除垃圾词后：

('相关', 0.78203125,

['精细化工',
71.42857142857143, ['生物降解', '添加剂', '水凝胶', '清洁生产', '纤维素', '蛋白质', '农业生产', '聚合物', '化学物质', '土壤污染', '化学品', '糖', '新材料', '水分', '地下水', '生物医学']
, 16],

['高分子化学',
58.03571428571428, ['水凝胶', '纤维素', '聚合物', '生物降解', '清洁生产', '添加剂', '蛋白质', '食品工业', '糖', '土壤污染', '海藻酸', '地下水', '化学品'], 13],

['环境化学',
58.03571428571428, ['地下水', '生物降解', '添加剂', '土壤污染', '化学物质', '纤维素', '土壤', '蛋白质', '地表水', '聚合物', '化学品', '生物聚合', '食品工业'], 13],

['纳米材料', 55.80357142857143, ['聚合物', '纤维素', '生物降解', '水凝胶', '地下水', '添加剂', '蛋白质', '生物医学', '土壤污染', '食品工业'], 10],

['分离工程', 53.57142857142857, ['水凝胶', '纤维素', '添加剂', '聚合物', '蛋白质', '地下水', '清洁生产', '生物降解', '用水量', '食品工业', '化学物质', '化学品'],
12],

['环境生态与毒理学', 53.57142857142857, ['生物降解', '地下水', '土壤污染', '化学品', '土壤', '化学物质', '蛋白质', '纤维素', '水凝胶', '添加剂', '食品工业', '藻'],
12],

['三废', 53.57142857142857, ['清洁生产', '地下水', '土壤污染', '生物降解', '化学物质', '添加剂', '蛋白质', '纤维素', '聚合物', '化学品', '水凝胶', '新材料'], 12]]

**可以考虑加上的词：污染（加到环境化学和三废）**

**改进：加入到了环境的子学科，且水体加上了‘水体污染’，土壤等同理**

加上后：

('相关', 0.7984375,

['精细化工',
71.42857142857143, ['生物降解', '添加剂', '水凝胶', '清洁生产', '纤维素', '蛋白质', '农业生产', '聚合物', '化学物质', '土壤污染', '化学品', '糖', '新材料', '水分', '地下水', '生物医学']
, 16],

['环境化学',
62.499999999999986, ['地下水', '生物降解', '添加剂', '土壤污染', '化学物质', '纤维素', '土壤', '蛋白质', '地表水', '聚合物', '化学品', '生物聚合', '食品工业', '污染']
, 14],

['高分子化学',
58.03571428571428, ['水凝胶', '纤维素', '聚合物', '生物降解', '清洁生产', '添加剂', '蛋白质', '食品工业', '糖', '土壤污染', '海藻酸', '地下水', '化学品'], 13],

['环境生态与毒理学',
58.03571428571428, ['生物降解', '地下水', '土壤污染', '化学品', '土壤', '化学物质', '蛋白质', '纤维素', '水凝胶', '添加剂', '食品工业', '藻', '污染'], 13],

['三废', 58.03571428571428, ['清洁生产', '地下水', '土壤污染', '生物降解', '化学物质', '添加剂', '蛋白质', '纤维素', '聚合物', '化学品', '水凝胶', '新材料', '污染']
, 13],

['纳米材料', 55.80357142857143, ['聚合物', '纤维素', '生物降解', '水凝胶', '地下水', '添加剂', '蛋白质', '生物医学', '土壤污染', '食品工业'], 10],

['分离工程', 53.57142857142857, ['水凝胶', '纤维素', '添加剂', '聚合物', '蛋白质', '地下水', '清洁生产', '生物降解', '用水量', '食品工业', '化学物质', '化学品'],
12]], [('土壤', 5), ('农业', 5), ('水凝胶', 3), ('肥料', 3), ('化学品', 2)])

**相关度分数好低** 先不管

纳米材料词表很垃圾，又要让他出现，所以设置了一个较低的阈值（分母），结果不需要他出现的时候他来了，削弱一下吧 0.28 -> 0.3

高分子化学没有问题，因为水凝胶就是高分子组成的。

#### 算法改进

之前的算法返回得分前三名的标签，会出现比如：第四名和第三名得分相同，但由于之多输出三个没有被输出的情况。

现在输出前三名，并保留所有并列的标签

**方法：使用pandas的nlargest(keep='all')方法**

1. pd.DataFrame(tags).nlargest(3,[1],keep='all').index得到前三高的所有标签的Index
2. 使用numpy不连续索引或者take()得到tags,

   或者使用列表推导式
    ``` python
    [tttt[i] for i in pd.DataFrame(tttt).nlargest(3,[1],keep='all').index]
    ```
   结果想想看不用这么麻烦，直接dataframe.values（numpy数组） 转list就好了

顺便回顾一下通知类的逻辑，如果文章中出现某个标签名，这个直接100分，如果这个标签不存在于原来的结果中，那就append，不然就改成100

**但是现在通用类的都被过滤完了还有用吗**

### 总结

- 优化了词表
- 算法优化：返回所有前三名的标签（可以并列）
- 删除了post_tags2接口，测试在本地做就可以了